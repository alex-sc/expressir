#!/usr/bin/env ruby

require "yaml"
require "expressir/express_exp/parser"
require "expressir/express_exp/formatter"
require "expressir/express_exp/schema_head_formatter"
require "expressir/express_exp/hyperlink_formatter"

exp_files = ARGV

repository = Expressir::ExpressExp::Parser.from_files(exp_files)
formatter = Class.new(Expressir::ExpressExp::Formatter) do
  include Expressir::ExpressExp::SchemaHeadFormatter
  include Expressir::ExpressExp::HyperlinkFormatter
end
result = repository.to_hash(formatter: formatter, skip_empty: true)

puts YAML.dump(result)